{
  "parameters": [
    {
      "name": "domain",
      "label": "Public Domain",
      "type": "string",
      "required": true,
      "display": true
    },
    {
      "name": "plan",
      "label": "Plan",
      "type": "string",
      "required": true,
      "display": true,
      "allowedValues": [
        {
          "value": "cores_4",
          "label": "4 Cores, 8 GB RAM, 160 GB SSD"
        },
        {
          "value": "cores_8",
          "label": "8 Cores, 32 GB RAM, 640 GB SSD"
        },
        {
          "value": "cores_16",
          "label": "16 Cores, 64 GB RAM, 1280 GB SSD"
        }
      ]
    }
  ],
  "afterInstallationInstructions": "Create a new A record from your domain ",
  "pricingModel": "fixed",
  "resources": [
    {
      "name": "Virtual Machine",
      "id": "vm",
      "type": "vultr-vm",
      "parameters": {
        "apiKey": "${env.apiKey}"
      },
      "mappings": {
        "plan": {
          "value": "${parameters.plan}",
          "map": {
            "cores_4": "vc2-4c-8gb",
            "cores_8": "vc2-8c-32gb",
            "cores_16": "vc2-16c-64gb"
          }
        }
      }
    },
    {
      "name": "Squidex",
      "id": "squidex",
      "type": "docker-compose-ssh",
      "parameters": {
        "dockerComposeUrl": "https://raw.githubusercontent.com/Squidex/squidex-hosting/refs/heads/master/docker-compose/docker-compose.yml"
      },
      "healthChecks": [
        {
          "name": "Default",
          "url": "https://${parameters.domain}/healthz",
          "type": "http"
        }
      ]
    }
  ],
  "prices": [
    {
      "target": "${parameters.plan}",
      "test": "cores_4",
      "amount": 80
    }
  ],
  "usage": {
    "totalCores": "${parameters.mongoDbNodes * parameters.mongoDbCoresPerNode + (parameters.squidexNodes + 1) * parameters.squidexCoresPerNode}"
  }
}